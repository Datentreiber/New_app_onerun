version: 2
id: "cool_spots"
title: "Sommer-Hitzeinseln"
purpose: "Sommerliche LST-Hotspots identifizieren."

param_spec:
  required:
    - id: aoi_spec
      type: object
      variants:
        - { type: "bbox", bbox: [0, 0, 0, 0] }
        - { type: "point_buffer", point: [0, 0], radius_km: 0 }
        - { type: "place", name: "", radius_km: 0 }
      ask_policy: "always"
    - id: time_year
      type: int
      range: [1980, 2035]
      ask_policy: "always"
  optional:
    - id: left_year
      type: int
      range: [1980, 2035]
      default: 2018
    - id: right_year
      type: int
      range: [1980, 2035]
      default: 2024
    - id: percentile
      type: int
      range: [10, 99]
      default: 90

invariants:
  summer_months: [6, 7, 8]
  sensor: "Landsat 8/9 SR (LST)"
  scale_m: 30
  to_celsius: "LST_C = LST_K - 273.15"

visualize_presets:
  - id: "temp_default"
    vis_params:
      min: 20
      max: 45
      palette: ["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffbf","#fee090","#fdae61","#f46d43","#d73027","#a50026"]
      opacity: 0.6

allowed_patterns:
  - "Scaffold → Acquire → Process → Reduce → Visualize → Render"

capabilities_required: ["aoi","summer_window"]
capabilities_provided: ["split_map","single_map","colorbar"]

ui_contracts:
  variables_map:
    year: "time_year"
    percentile: "percentile"

render_pattern: "split_map_right"

checks:
  - "Wenn Sommerfenster leer: Hinweis (Wolken oder Jahresauswahl prüfen)."

few_shot_components:
  - "blocks/components/gee/aoi_from_spec.py"
  - "blocks/components/gee/cool_spots_time.py"
  - "blocks/components/gee/cool_spots_acquire_process.py"
  - "blocks/components/visual/split_map_right.py"
  - "blocks/components/ui/slider_int.py"
  - "blocks/components/ui/number_input_int.py"
