version: 2
id: "cool_spots"
title: "Sommer-Hitzeinseln"
purpose: "Sommerliche LST-Hotspots identifizieren."

param_spec:
  required:
    - id: aoi_spec
      type: object
      variants:
        - { type: "bbox", bbox: [0, 0, 0, 0] }
        - { type: "point_buffer", point: [0, 0], radius_km: 0 }
        - { type: "place", name: "", radius_km: 0 }
      ask_policy: "always"
    - id: time_year
      type: int
      range: [2013, 2025]
      default: "current_year"
      ask_policy: "always"

ui_widgets_library:
  year_slider_int: "blocks/components/ui/slider_int.py"
  year_number_input: "blocks/components/ui/number_input_int.py"

invariants:
  dataset: "LANDSAT L2 (LC08/LC09 C02 T1 L2)"
  qa_mask_bits_zero: [1, 2, 3, 4, 5]
  lst_formula_kelvin: "LST_K = ST_B10 * 0.00341802 + 149.0"
  to_celsius: "LST_C = LST_K - 273.15"

visualize_presets:
  - id: "temp_default"
    vis_params:
      min: 20
      max: 45
      palette: ["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffbf","#fee090","#fdae61","#f46d43","#d73027","#a50026"]
      opacity: 0.6

allowed_patterns:
  - "Scaffold → Acquire → Process → Reduce → Visualize → Render"

capabilities_required: ["aoi","summer_window"]
capabilities_provided: ["qa_mask_l2","lst_celsius","visualize_hot","split_map"]

ui_contracts:
  bindings:
    time_year: "int"
  variables_map:
    year: "time_year"

render_pattern: "split_map_right"

checks:
  - "Wenn die Bildsammlung leer ist: Hinweis ausgeben und Parameter prüfen."

few_shot_components:
  - "blocks/components/gee/aoi_from_spec.py"
  - "blocks/components/gee/cool_spots_time.py"
  - "blocks/components/gee/cool_spots_acquire_process.py"
  - "blocks/components/visual/split_map_right.py"
  - "blocks/components/ui/slider_int.py"
  - "blocks/components/ui/number_input_int.py"
