version: 2
id: "night_lights_breaks"
title: "Nighttime Lights — Bruchdetektion"
purpose: "Strukturelle Änderungen in monatlichen Nachtlichtern erkennen."

param_spec:
  required:
    - id: aoi_spec
      type: object
      variants:
        - { type: "bbox", bbox: [0, 0, 0, 0] }
        - { type: "point_buffer", point: [0, 0], radius_km: 0 }
        - { type: "place", name: "", radius_km: 0 }
      ask_policy: "always"
  optional:
    - id: year_min
      type: int
      range: [2012, 2025]
      default: 2018
      ask_policy: "prefer"
    - id: year_max
      type: int
      range: [2012, 2025]
      default: 2025
      ask_policy: "prefer"

ui_widgets_library:
  year_slider_int: "blocks/components/ui/slider_int.py"
  year_number_input: "blocks/components/ui/number_input_int.py"

invariants:
  dataset_primary: "NOAA/VIIRS/DNB/MONTHLY_V1/VCMSLCFG"
  dataset_fallback: "NOAA/VIIRS/DNB/MONTHLY_V1/VCMCFG"
  band: "avg_rad"

visualize_presets:
  - id: "viirs_default"
    vis_params:
      min: 0.0
      max: 40.0
      palette: ["#000004","#2c105c","#711f81","#b63679","#ed6925","#fbb61a","#fcffa4"]
      opacity: 0.8

allowed_patterns:
  - "Scaffold → Acquire → Reduce → Analyze → Visualize → Render"

capabilities_required: ["aoi","timeseries"]
capabilities_provided: ["change_detection","split_map","single_map","chart"]

ui_contracts:
  variables_map: {}

render_pattern: "split_map_right"

checks:
  - "Wenn keine Monate im Intervall: Hinweis und Intervall anpassen."

few_shot_components:
  - "blocks/components/gee/aoi_from_spec.py"
  - "blocks/components/visual/split_map_right.py"
