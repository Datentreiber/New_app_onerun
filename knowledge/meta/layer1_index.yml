# ==== Ergänzungsvorschlag für knowledge/meta/layer1_index.yml ====
version: 1
# Governance: global & append-only. Neue UCs ergänzen Einträge; bestehende Keys nicht überschreiben.

facets:
  phenomenon:
    - key: surface_temp
      label: "Sommer-Hitzeinseln"
      desc: "Wie heiß sind Flächen im Sommer?"
    - key: vegetation_index
      label: "Vegetation (NDVI)"
      desc: "Wie entwickelt sich die Vegetation über das Jahr?"
    - key: air_quality
      label: "Luftqualität (NO₂)"
      desc: "Wie hoch ist die NO₂-Belastung?"
    - key: s2_visual
      label: "Satellitenbild (S2)"
      desc: "True/Faux-Color-Ansichten ohne Analyse."
    - key: urban_built
      label: "Bebaute Fläche"
      desc: "Ausmaß urbaner Bebauung."
    - key: night_lights
      label: "Nachtlichter"
      desc: "Helle Bereiche und Veränderungen in Nachtlichtern."
  time_granularity:
    - key: seasonal
      label: "Saisonal (Sommer)"
      desc: "Juni–August, jahresweise vergleichbar."
    - key: quarterly
      label: "Quartale"
      desc: "Dreimonatsfenster (Q1–Q4)."
    - key: monthly
      label: "Monatlich"
      desc: "Einzelne Monate als Mittel."
    - key: annual
      label: "Jährlich"
      desc: "Jahrgangsvergleiche."
  aoi_language:
    - key: nl_place
      label: "Ort/Region"
      desc: "z. B. 'Shenzhen, China'."
    - key: nl_coords
      label: "Koordinaten"
      desc: "lon, lat – optional Radius."
    - key: nl_bbox
      label: "Bounding Box"
      desc: "minLon, minLat, maxLon, maxLat."
    - key: nl_region_name
      label: "Benannte Region"
      desc: "z. B. 'Bayern, Deutschland'."
  output_modes:
    - key: single_map
      label: "Karte"
      desc: "Ein Layer."
    - key: split_map
      label: "Split-Karte"
      desc: "Links vs. rechts Vergleich."
    - key: animation
      label: "Animation"
      desc: "Abfolge von Bildern."
    - key: chart
      label: "Diagramm"
      desc: "Zeitreihe."
  ui_elements:
    - key: slider_int
      label: "Schieberegler (Ganzzahl)"
      desc: "Min/Max/Step einstellbar."
    - key: number_input_int
      label: "Zahleneingabe (Ganzzahl)"
      desc: "Min/Max/Step einstellbar."
  units:
    - key: degC
      label: "°C"
      desc: "Grad Celsius."
    - key: mol_m2
      label: "mol/m²"
      desc: "Spaltenintegral."
    - key: index
      label: "Index"
      desc: "NDVI etc."
  sensors:
    - key: Landsat_L2
      label: "Landsat 8/9 L2"
      desc: "Thermal & reflektive Bänder."
    - key: MODIS
      label: "MODIS"
      desc: "NDVI-Produkte."
    - key: TROPOMI
      label: "TROPOMI"
      desc: "S5P NO₂."
    - key: Sentinel2
      label: "Sentinel-2"
      desc: "Multispektral."
    - key: VIIRS
      label: "VIIRS"
      desc: "Nachtlichter."

synonyms:
  surface_temp: ["Hitzeinseln","LST","Sommer-Hotspots"]
  vegetation_index: ["NDVI","Grünindex","Vegetation"]
  air_quality: ["NO2","Stickstoffdioxid"]
  s2_visual: ["Satellitenbild","True Color","Faux Color"]
  urban_built: ["Urbanisierung","Bebauung"]
  night_lights: ["Nachtlichter","Nighttime lights","Lichtemissionen"]

negatives:
  - want: "Minütliche NO₂-Werte live"
    redirect: ["Monatliches NO₂-Mittel", "Tagesüberflug NO₂ (S5P)"]
  - want: "Handgemalte AOI-Polygone"
    redirect: ["AOI per Ort/Koordinate/Bounding-Box beschreiben"]

mini_stories:
  - user: "Zeig mir heiße Flecken in München."
    options: ["Sommer-Hitzeinseln"]
    why: "Sommer + Stadt → Temperaturkarte sinnvoll."
  - user: "Ich will den Jahreslauf der Vegetation in Europa sehen."
    options: ["NDVI Timelapse (Monatsverlauf)"]
    why: "NDVI-Animation zeigt saisonale Muster."
  - user: "Wie war NO₂ im Juli 2023 über Berlin?"
    options: ["NO₂ Monatsmittel (TROPOMI)"]
    why: "Monatsmittel glättet Ausreißer und zeigt das Niveau."
  - user: "Gib mir ein frisches S2-Bild von Q3 für Rom."
    options: ["S2 Vierteljahres-Mosaik (FCC)"]
    why: "Quartals-Median mindert Wolken, FCC zeigt Details."

uc_inventory_meta:
  - id: "cool_spots"
    title: "Sommer-Hitzeinseln"
    lead_facets: ["surface_temp","seasonal","nl_place"]
    caps: ["aoi","time_window","split_map"]
  - id: "ndvi_timelapse"
    title: "NDVI Timelapse"
    lead_facets: ["vegetation_index","annual","nl_region_name"]
    caps: ["aoi","animation","single_map"]
  - id: "no2_monthly"
    title: "NO₂ Monatsmittel"
    lead_facets: ["air_quality","monthly","nl_place"]
    caps: ["aoi","time_window","single_map"]
  - id: "s2_visual"
    title: "S2 Vierteljahres-Mosaik"
    lead_facets: ["s2_visual","quarterly","nl_place"]
    caps: ["aoi","time_window","split_map"]
  - id: "urban_built"
    title: "Bebaute Fläche"
    lead_facets: ["urban_built","annual","nl_place"]
    caps: ["aoi","split_map","single_map"]
  - id: "night_lights_breaks"
    title: "Nachtlichter – Bruchdetektion"
    lead_facets: ["night_lights","monthly","nl_place"]
    caps: ["aoi","timeseries","change_detection","split_map"]

modes_signals:
  direct: ["mach","erzeuge","berechne","erstelle"]
  exploratory: ["zeig mir möglichkeiten","weiß noch nicht","was geht"]
  redirect: ["3-stündlich","minutengenau","echtzeit"]

handoff_heuristics:
  - if: "clarity in {solid} or readiness=direct"
    then: "load param_spec of top UC (partially)"

calibration_axes:
  clarity_level:
    - none: "Noch keine klare Fragestellung; eher vage Neugier."
    - partial: "Ein Ziel wird sichtbar, aber ein oder zwei Dinge fehlen."
    - solid: "Klar genug, um auf einen Use-Case zu committen."
  readiness_level:
    - exploratory: "Erst Orientierung/Überblick gewünscht."
    - guided: "Gezielte Unterstützung mit wenigen Optionen."
    - direct: "Sofort konkretisieren und ausführen."
  feasibility_status:
    - ok: "Wunsch ist machbar."
    - redirect: "So nicht sinnvoll; Alternativen sind verfügbar."
    - blocked: "Mit den vorhandenen Bausteinen nicht möglich."
  commit_status:
    - uncommitted: "Noch kein UC festgelegt."
    - committed: "UC gewählt; Details klären."
  cognitive_budget:
    - small: "Nur eine Nachfrage/Option sinnvoll."
    - normal: "Ein, zwei Optionen und eine Nachfrage."
    - wide: "Kurzvergleich von zwei Pfaden ist vertretbar."

dialog_moves:
  - id: ORIENT
    goal: "Niedrigschwellige Einordnung ohne Technik."
    when: ["clarity_level in [none, partial] and readiness_level = exploratory"]
    do: "1–2 Pfade mit je 1 Satz Nutzen nennen."
  - id: PROBE
    goal: "Gezielte Lücke schließen (AOI, Zeit, Output)."
    when: ["clarity_level != solid or required params missing"]
    do: "Eine klare Frage, ein Beispiel (natürlichsprachlich)."
  - id: OFFER
    goal: "Kuratierte Auswahl geben."
    when: ["readiness_level in [exploratory, guided]"]
    do: "2–3 Optionen, je 1 Satz Konsequenz."
  - id: REDIRECT
    goal: "Unmöglichen Wunsch in Machbares überführen."
    when: ["feasibility_status in [redirect, blocked]"]
    do: "1–2 echte Alternativen (existierende UCs) vorschlagen."
  - id: COMMIT
    goal: "Auf einen UC festlegen."
    when: ["clarity_level = solid or user chooses UC"]
    do: "UC benennen (alltagsnah), dann Details abfragen."
  - id: RECAP
    goal: "Vor L1.2/L3 kognitiv verankern."
    when: ["Kurz vor L1.2-Peek oder Code-Emission"]
    do: "1 Satz Zusammenfassung, keine Technik."
  - id: GUARD
    goal: "Verständliches, knappes Fehlerfeedback + Vorschlag."
    when: ["Empty collection", "Bands fehlen", "Policy-Verstoß"]
    do: "Ein Satz Problem, ein Satz Handlungsvorschlag."

probes_library:
  # Formulierungs-Bausteine in Alltagssprache (keine Feldnamen)
  aoi:
    - "Sollen wir mit einem Ort (z. B. 'Shenzhen, China'), Koordinaten (lon, lat + Radius) oder einer Bounding Box arbeiten?"
    - "Wenn du magst: Nenn mir einfach einen Ort und optional einen Radius in km."
  time:
    - "Geht es dir um einen Sommer, ein Quartal oder einen bestimmten Monat/Jahr?"
    - "Welcher Zeitraum zeigt dein Thema am besten?"
  output:
    - "Möchtest du eine Karte, einen Links-/Rechts-Vergleich oder eher eine kurze Animation?"
  expectation:
    - "Worauf achtest du bei dem Ergebnis zuerst—grobe Muster oder feine Details?"

redirect_catalog:
  - want: "Minütliche NO₂-Karten"
    to:    ["no2_monthly"]
    why:   "Monatsmittel sind robust und über große Gebiete verfügbar."
  - want: "AOI auf der Karte malen"
    to:    ["cool_spots","s2_visual","no2_monthly","ndvi_timelapse"]
    why:   "Beschreibe den Ort/Koordinate/Bounding Box—so klappt es ohne Uploads."

commit_criteria:
  # Wann L1.1 auf einen UC „einloggt“
  - "Phänomen + Zeitkörnung + AOI-Stil sind benannt oder akzeptiert."
  - "Feasibility = ok (oder redirect akzeptiert)."
  - "Nutzer:in bestätigt die Richtung in eigenen Worten."

option_budget_rules:
  direct: 1
  guided: 2
  exploratory: 3

handoff_rules:
  # Wann partiell L1.2 laden?
  - if: "clarity_level = solid"
    then: "Lade param_spec (required/optional) des Top-UC."
  - if: "readiness_level = direct and missing just 1 required"
    then: "Stelle 1 PROBE; danach L1.2 param_spec laden."
  - if: "feasibility_status = redirect"
    then: "Nenne 1–2 Alternativen (existierende UCs); nach Bestätigung → L1.2 param_spec."
